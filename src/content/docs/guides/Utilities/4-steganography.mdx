---
title: Steganography
description: Explore using steganography to hide messages in images and bitmaps.
category: Guides
author: Brianna Laird
lastupdated: November 2024
---

import { Tabs, TabItem, Steps } from "@astrojs/starlight/components";

**{frontmatter.description}**  
Written by: {frontmatter.author}  
_Last updated: {frontmatter.lastupdated}_

---

Steganography is the practice of concealing a message within another message or medium. In this guide, we will explore how to use steganography to hide messages in bitmaps, covering how to implement a program to embed and extract messages from images using Least Significant Bit (LSB) steganography. We will also discuss how to enhance the security of hidden messages by applying the Caesar Cipher to the plaintext before embedding it in the image.

## What is Steganography?

Steganography is an ancient technique of hiding information in plain sight. The term is derived from the Greek words steganos (covered) and graphein (writing), meaning "covered writing." Unlike encryption, which scrambles the content of a message to make it unreadable to unauthorised parties, steganography disguises the very existence of the message by embedding it within another seemingly innocuous medium, such as an image, audio file, or text document.

Modern digital steganography often takes advantage of the characteristics of multimedia files to hide information. Images are particularly useful for this purpose because their pixel data provides a high degree of redundancy, which means small changes in pixel values are imperceptible to the human eye. For added security, steganography is frequently combined with encryption, ensuring that even if a hidden message is discovered, it remains unreadable without the proper decryption key.

### Applications of Steganography

Steganography has a range of applications, both benign and malicious. Legitimate uses include watermarking to protect intellectual property, secure communication in censorship-prone environments, and embedding metadata for digital forensics. However, it has also been misused for covert communication in cybercrime and espionage. This dual-use nature makes it a fascinating but critical subject in cybersecurity.

## How Does Steganography Work?

At its core, digital steganography involves embedding a secret message within a host medium. For images, this is typically done by modifying the binary representation of pixel values. Each pixel in a digital image is represented by a combination of red, green, and blue (RGB) color values. These values are stored as binary numbers, allowing for subtle alterations to be made without visibly affecting the image.

The most common method is Least Significant Bit (LSB) Steganography, where the least significant bit (the last bit in a binary number) of each pixel is replaced with a bit from the secret message. This approach leverages the fact that small changes to the least significant bit have negligible visual impact on the image.

For example, consider the binary representation of a pixel's red channel:

```plaintext
Original: 11110010
Modified: 11110011
```

The difference between these two values is imperceptible to the human eye, but the change encodes a bit of the hidden message.

To ensure the hidden message can be retrieved, both the sender and receiver must agree on an encoding scheme. This includes specifying which bits will carry the hidden data and how the message length will be encoded.

### Why Use Base64 Encoding?

Before embedding the message, encoding it in a format like Base64 is common. Base64 ensures that the message is represented using only printable characters, making it easier to handle and less prone to corruption during transmission. This step is particularly useful when the message contains non-textual or binary data.

## Using Steganography to Hide Messages in Images

In this guide, we will demonstrate how to use steganography to hide messages within bitmap images using LSB steganography. This technique is straightforward, making it ideal for beginners, while still being robust enough to illustrate the core principles of steganography.

### Embedding a Message in an Image

To hide a message:

<Steps>
1. **Choose an Image:** Any bitmap image can be used, but high-resolution images provide more space for hiding data. For this guide, we'll use a bitmap image of a cat.
2. **Prepare the Message:** The message will be encoded in Base64 before embedding to ensure compatibility and readability.
3. **Embed the Message:** Using LSB steganography, replace the least significant bits of the image's pixel data with bits from the encoded message.
</Steps>

### Code Example

Here is how you can embed a message in a bitmap using C++, C#, or Python:

:::note
You will need to update the path to be the path to your bitmap file.
:::

<Tabs syncKey="code-language">
<TabItem label="C++">

```cpp

```

</TabItem>
<TabItem label="C#">

<Tabs syncKey="csharp-style">
<TabItem label="Top-level Statements">

```csharp

```

</TabItem>
<TabItem label="Object-Oriented">

```csharp

```

</TabItem>
</Tabs>

</TabItem>
<TabItem label="Python">

```python

```

</TabItem>
</Tabs>

### Expected Output

After embedding the message, you'll see an output like:

```plaintext
Enter the message to embed: 
im a cat
Base64-encoded message: aW0gYSBjYXQ=
Base64 length (in characters): 12
Binary message: 011000010101011100110000011001110101100101010011010000100110101001011001010110000101000100111101
Length bits: 00000000000000000000000000001100

Original binary data at embedding positions (truncated):
0110011110001110010000100110011110001110010000100110011110001110...0110011110001110010000100110011110001110010000100110011110001110

Modified binary data at embedding positions (truncated):
0110011010001110010000100110011010001110010000100110011010001110...0110011010001110010000110110011110001111010000110110011010001111
Message embedded successfully in Base64! Encoded image saved as /yourfolders/hiddencat.bmp.
```

The comparison between the original and modified binary data highlights the subtle but precise changes made during the embedding process. Notice how the least significant bits (LSBs) of the original binary data are modified to encode the length and content of the hidden message. These alterations are so minor that they do not visibly affect the image, yet they securely store the message within its pixel data. This clever manipulation of binary values demonstrates the power of steganography, where seemingly insignificant details carry meaningful information—hidden in plain sight. By preserving the image's integrity while embedding a secret, this technique showcases how technology can be used creatively to protect and communicate information.

## Extracting a Message from an Image

To retrieve the hidden message, the recipient must reverse the embedding process. This involves:

<Steps>
1. **Load the Image:** Open the image containing the hidden message.
2. **Extract the Message Length:** Retrieve the length of the hidden message from the least significant bits of the image's pixel data.
3. **Extract the Message:** Using the message length, extract the hidden message from the least significant bits of the image's pixel data.
4. **Decode the Message:** Decode the extracted message from Base64 to reveal the original content.
</Steps>

### Code Example

Here is how you can extract a message from a bitmap using C++, C#, or Python:

:::note
You will need to update the path to be the path to your bitmap file.
:::

<Tabs syncKey="code-language">
<TabItem label="C++">

```cpp

```

</TabItem>
<TabItem label="C#">

<Tabs syncKey="csharp-style">
<TabItem label="Top-level Statements">

```csharp

```

</TabItem>
<TabItem label="Object-Oriented">

```csharp

```

</TabItem>
</Tabs>

</TabItem>
<TabItem label="Python">

```python

```

</TabItem>
</Tabs>

### Expected Output

After extracting the message, you'll see an output like:

```plaintext
Length bits: 00000000000000000000000000001100
Extracted Base64 length (in characters): 12
Extracted Base64 message: aW0gYSBjYXQ=
Extracted Binary message: 011000010101011100110000011001110101100101010011010000100110101001011001010110000101000100111101
Extracted message: im a cat
```

The extracted message is identical to the original message, demonstrating the successful retrieval of the hidden information. By following the reverse process of the embedding algorithm, the recipient can recover the message without any visible changes to the image. This seamless integration of data within the image's pixel data showcases the elegance and effectiveness of LSB steganography as a method of secure communication.

## Enhancing Security with the Caesar Cipher

Before embedding the message in the image using Base64 encoding, an additional layer of obfuscation can be applied to make the message more secure. One simple technique for this is the **Caesar Cipher**. Named after Julius Caesar, who reportedly used it in his private correspondence, the Caesar Cipher is a substitution cipher that shifts each character in the plaintext by a fixed number of positions in the alphabet.

By applying a Caesar Cipher to the message prior to Base64 encoding, you introduce an extra hurdle for anyone trying to extract and interpret the hidden message without the necessary key. This is particularly useful when the steganographic embedding is coupled with plaintext messages. However, in real-world scenarios, more advanced encryption techniques should be used for sensitive information as the Caesar Cipher is relatively easy to break.

### How the Caesar Cipher Works

The Caesar Cipher replaces each letter in the message with another letter a fixed number of positions down (or up) the alphabet. For example, with a shift of 3:

- `A` becomes `D`
- `B` becomes `E`
- `C` becomes `F`

The process wraps around at the end of the alphabet, so `X` becomes `A`, `Y` becomes `B`, and `Z` becomes `C`. Numbers and punctuation are typically left unchanged, but this can vary based on implementation.

To decrypt a Caesar Cipher message, the recipient simply shifts the letters in the opposite direction by the same number of positions.

### Applying Caesar Cipher to Steganography

Here’s how the process works:

<Steps>
1. **Plaintext Message:** Start with the original message (e.g., `"im a cat"`).
2. **Apply Caesar Cipher:** Obfuscate the message using a chosen shift value (e.g., `3`). The message `"im a cat"` might become `"lp d fdw"`.
3. **Encode in Base64:** Convert the obfuscated message into Base64, producing a string of printable characters.
4. **Embed in Image:** Use LSB steganography to embed the Base64-encoded string into the image.
</Steps>

To extract and interpret the message, the reverse process is followed:

<Steps>
1. **Extract the Base64 Message:** Decode the embedded Base64 string from the image.
2. **Decrypt Caesar Cipher:** Apply the inverse Caesar Cipher shift to recover the original plaintext message.
</Steps>

By combining Caesar Cipher obfuscation with LSB steganography, you can enhance the security of your hidden messages while exploring the principles of encryption and steganography. Here is how you can implement this in your code:

<Tabs syncKey="code-language">
<TabItem label="C++">

```cpp

```

</TabItem>
<TabItem label="C#">

<Tabs syncKey="csharp-style">
<TabItem label="Top-level Statements">

```csharp

```

</TabItem>
<TabItem label="Object-Oriented">

```csharp

```

</TabItem>
</Tabs>

</TabItem>
<TabItem label="Python">

```python

```

</TabItem>
</Tabs>

### Expected Output

After extracting the message and decrypting it using the Caesar Cipher, you'll see an output like:

```plaintext
Enter the message to embed: 
im a cat
Enter the Caesar cipher shift value: 
8
Caesar cipher shifted message: qu i kib
Base64-encoded message: cXUgaSBraWI=
Base64 length (in characters): 12
Length bits: 00000000000000000000000000001100
Message embedded successfully in Base64! Encoded image saved as /yourfolders/hiddencat.bmp.
```

If we then run the same decode script, we would see:

```plaintext
Length bits: 00000000000000000000000000001100
Extracted Base64 length (in characters): 12
Extracted Base64 message: cXUgaSBraWI=
Extracted message: qu i kib
```

So now, while someone can extract the message, they would need to know that you used Ceaser Cipher, as well as what the shift value was, to get the original message.
